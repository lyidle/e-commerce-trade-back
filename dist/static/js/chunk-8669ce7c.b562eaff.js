(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8669ce7c"],{"542f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticStyle:{margin:"20px 0"}},[a("CategorySelect",{attrs:{show:!t.isShowTable},on:{submitCategoryId:t.getCategoryId}})],1),a("el-card",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTable,expression:"isShowTable"}]},[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.category3Id},on:{click:t.addAttr}},[t._v("添加属性")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.attrList,border:""}},[a("el-table-column",{attrs:{type:"index",prop:"prop",label:"序号",align:"center",width:"80"}}),a("el-table-column",{attrs:{prop:"attrName",label:"属性名称",width:"150"}}),a("el-table-column",{attrs:{prop:"prop",label:"属性值列表",width:"width"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return t._l(r.attrValueList,(function(e){return a("el-tag",{key:e.id,staticStyle:{margin:"10px"},attrs:{type:"success"}},[t._v(t._s(e.valueName))])}))}}])}),a("el-table-column",{attrs:{prop:"prop",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini"},on:{click:function(e){return t.updateAttr(r)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteAttrList(r)}}})]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowTable,expression:"!isShowTable"}]},[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"80px",model:t.attrInfo}},[a("el-form-item",{attrs:{label:"属性名"}},[a("el-input",{attrs:{placeholder:"请输入属性名"},model:{value:t.attrInfo.attrName,callback:function(e){t.$set(t.attrInfo,"attrName",e)},expression:"attrInfo.attrName"}})],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.attrInfo.attrName.trim().length},on:{click:t.addAttrValue}},[t._v("添加属性值")]),a("el-button",{on:{click:function(e){t.isShowTable=!0}}},[t._v("取消")]),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.attrInfo.attrValueList}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"80"}}),a("el-table-column",{attrs:{prop:"prop",label:"属性值名称",width:"width"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row,n=e.$index;return[r.flag?a("el-input",{ref:n,attrs:{placeholder:"",size:"mini"},on:{blur:function(e){return t.toLook(r)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toLook(r)}},model:{value:r.valueName,callback:function(e){t.$set(r,"valueName",e)},expression:"row.valueName"}}):a("span",{staticStyle:{display:"block"},on:{click:function(e){return t.toEdit(r,n)}}},[t._v(t._s(r.valueName))])]}}])}),a("el-table-column",{attrs:{prop:"prop",label:"操作",width:"width"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row,n=e.$index;return[a("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定删除"+r.valueName+"吗？"},on:{onConfirm:function(e){return t.deleteAttrValue(n)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"})],1)]}}])})],1),a("el-button",{attrs:{type:"primary",disabled:t.attrInfo.attrValueList.length<1},on:{click:t.addOrUpdateAttr}},[t._v("保存")]),a("el-button",{on:{click:function(e){t.isShowTable=!0}}},[t._v("取消")])],1)],1)])],1)},n=[],i=a("c7eb"),o=a("1da1"),s=(a("4de4"),a("7db0"),a("a434"),a("e9c4"),a("b64b"),a("d3b7"),a("498a"),a("159b"),{name:"Attr",data:function(){return{category1Id:"",category2Id:"",category3Id:"",attrList:[],isShowTable:!0,attrInfo:{attrName:"",attrValueList:[],categoryId:0,categoryLevel:3}}},methods:{getCategoryId:function(t){var e=t.categoryId,a=t.level;switch(a){case 1:this.category1Id=e,this.category2Id="",this.category3Id="";break;case 2:this.category2Id=e,this.category3Id="";break;case 3:this.category3Id=e,this.getAttrList();break}},getAttrList:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a,r,n,o;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.category1Id,r=t.category2Id,n=t.category3Id,e.prev=1,e.next=4,t.$API.attr.reqAttrList(a,r,n);case 4:o=e.sent,t.attrList=o.data,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](1);case 10:case"end":return e.stop()}}),e,null,[[1,8]])})))()},addAttrValue:function(){var t=this;this.attrInfo.attrValueList.push({attrId:this.attrInfo.id,valueName:"",flag:!0}),this.$nextTick((function(){t.$refs[t.attrInfo.attrValueList.length-1].focus()}))},addAttr:function(){this.isShowTable=!1,this.attrInfo={attrName:"",attrValueList:[],categoryId:this.category3Id,categoryLevel:3}},updateAttr:function(t){var e=this;this.isShowTable=!1,this.attrInfo=JSON.parse(JSON.stringify(t)),this.attrInfo.attrValueList.forEach((function(t){e.$set(t,"flag",!1)}))},toLook:function(t){if(""!=t.valueName.trim()){var e=this.attrInfo.attrValueList.find((function(e){if(t!==e)return t.valueName===e.valueName}));e?this.$message("不能输入重复的值!"):t.flag=!1}else this.$message("请输入一个正常的属性值!")},toEdit:function(t,e){var a=this;t.flag=!0,this.$nextTick((function(){a.$refs[e].focus()}))},deleteAttrValue:function(t){var e=this;this.$nextTick((function(){e.attrInfo.attrValueList.splice(t,1)}))},addOrUpdateAttr:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.attrInfo.attrValueList=t.attrInfo.attrValueList.filter((function(t){if(""!=t.valueName)return delete t.flag,!0})),e.prev=1,e.next=4,t.$API.attr.reqAddOrUpdateAttr(t.attrInfo);case 4:t.isShowTable=!0,t.$message({type:"success",message:"保存成功"}),t.getAttrList(),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$message({type:"warning",message:"保存失败"});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},deleteAttrList:function(t){var e=this;return Object(o["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.$API.attr.reqDeleteAttrList(t.attrValueList.attrId);case 3:e.$message({type:"success",message:"删除成功"}),a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),e.$message({type:"warning",message:"删除失败"});case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()}}}),l=s,c=a("0c7c"),u=Object(c["a"])(l,r,n,!1,null,"1c201231",null);e["default"]=u.exports},"7db0":function(t,e,a){"use strict";var r=a("23e7"),n=a("b727").find,i=a("44d2"),o=a("ae40"),s="find",l=!0,c=o(s);s in[]&&Array(1)[s]((function(){l=!1})),r({target:"Array",proto:!0,forced:l||!c},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i(s)},a434:function(t,e,a){"use strict";var r=a("23e7"),n=a("23cb"),i=a("a691"),o=a("50c4"),s=a("7b0b"),l=a("65f0"),c=a("8418"),u=a("1dde"),d=a("ae40"),f=u("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,b=Math.min,g=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f||!p},{splice:function(t,e){var a,r,u,d,f,p,v=s(this),y=o(v.length),w=n(t,y),I=arguments.length;if(0===I?a=r=0:1===I?(a=0,r=y-w):(a=I-2,r=b(h(i(e),0),y-w)),y+a-r>g)throw TypeError(m);for(u=l(v,r),d=0;d<r;d++)f=w+d,f in v&&c(u,d,v[f]);if(u.length=r,a<r){for(d=w;d<y-r;d++)f=d+r,p=d+a,f in v?v[p]=v[f]:delete v[p];for(d=y;d>y-r+a;d--)delete v[d-1]}else if(a>r)for(d=y-r;d>w;d--)f=d+r-1,p=d+a-1,f in v?v[p]=v[f]:delete v[p];for(d=0;d<a;d++)v[d+w]=arguments[d+2];return v.length=y-r+a,u}})},e9c4:function(t,e,a){var r=a("23e7"),n=a("d066"),i=a("d039"),o=n("JSON","stringify"),s=/[\uD800-\uDFFF]/g,l=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,u=function(t,e,a){var r=a.charAt(e-1),n=a.charAt(e+1);return l.test(t)&&!c.test(n)||c.test(t)&&!l.test(r)?"\\u"+t.charCodeAt(0).toString(16):t},d=i((function(){return'"\\udf06\\ud834"'!==o("\udf06\ud834")||'"\\udead"'!==o("\udead")}));o&&r({target:"JSON",stat:!0,forced:d},{stringify:function(t,e,a){var r=o.apply(null,arguments);return"string"==typeof r?r.replace(s,u):r}})}}]);